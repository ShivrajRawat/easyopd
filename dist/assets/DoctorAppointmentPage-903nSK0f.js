import{d as B,ax as ye,az as Ie,r as P,Q as X,_ as N,z as l,o as u,a as F,C as o,B as n,a2 as V,t as g,D as I,A as S,a3 as q,aO as ke,aP as we,b as $,i as Me,aQ as Pe,a8 as de,aR as Ae,H,c as y,M as O,T as Z,e as z,l as J,aS as Oe,g as Te,h as Fe,aF as Ve,ay as ue,ad as ce,ac as me,f as x,aT as Ee,n as pe,aa as fe,aU as Be,E as ve,W as oe,aV as Ne,aW as Le,aX as G,aY as W,ak as Re,al as qe,$ as ee,aZ as Ue,N as te,a_ as He,a$ as ze,R as K,b0 as We,b1 as Ye,am as R,b2 as je,ae as Ge,U as Qe,b3 as Ke,b4 as Xe,b5 as Ze,b6 as Je,V as xe,b7 as _e,b8 as et,b9 as be,ba as tt,bb as ae,u as nt,bc as ot,aB as at,a4 as lt,bd as st,be as it,bf as rt,bg as dt,I as ut,aw as ct}from"./index-QxsQlh4-.js";import{m as mt,b as le,D as Y,g as pt,a as ft,i as vt,L as _t,c as bt}from"./dateUtil-H8p96JqU.js";import{D as ht}from"./DoctorCard-IN2ozIny.js";import{P as he}from"./PageHeader-SgS1UYqj.js";import{M as U,u as ge}from"./useIonModal-P8FV7PBJ.js";import{b as gt,a as De,C as L,u as Dt}from"./index-FXKpo0ZJ.js";import{u as j}from"./appStore-D6ym7sz-.js";import{u as $t}from"./useFilters-r6jgkoit.js";const St=B({components:{IonSelect:ye,IonSelectOption:Ie},props:{options:{type:Array,required:!1,default:()=>[]}},setup(e,t){const d=P(t.attrs);return X(()=>{d.value=t.attrs}),{attrs:d}}}),Ct=$("div",{class:"select-highlight"},null,-1);function yt(e,t,d,i,r,_){const a=l("ion-select-option"),s=l("ion-select");return u(),F(V,null,[o(s,ke(we(e.attrs)),{default:n(()=>[(u(!0),F(V,null,q(e.options,p=>(u(),S(a,{key:p.key??p.value,value:p.value},{default:n(()=>[I(g(p.text),1)]),_:2},1032,["value"]))),128))]),_:1},16),Ct],64)}const It=N(St,[["render",yt]]),se="update:modelValue",kt=B({components:{IonInput:Me,IonDatetime:Pe,IonModal:de,IonDatetimeButton:Ae,IonLabel:H},emits:[se],props:{modelValue:String,label:String,name:{type:String,required:!0},asButton:Boolean},setup(e,t){const d=P(e.modelValue),i=P(""),r=y(()=>e.asButton?void 0:e.name+"_trigger"),_=y(()=>e.name+"_date"),a=P(t.attrs);X(()=>{a.value=t.attrs});function s(c){if(c){const m=c.detail.value&&Array.isArray(c.detail.value)?c.detail.value[0]:c.detail.value.toString();if(m){const{usFormat:f,indiaFormat:w}=mt(m);d.value=w,t.emit(se,f)}}}const p=c=>{i.value=c?"focused":""},h=y(()=>a.value.position||a.value["label-placement"]),b=y(()=>a.value.showButtons),D=y(()=>a.value.showTitle),C=y(()=>a.value.calendarFirstDayOfWeek||1);return{attrs:a,datetimeFocus:p,focusClass:i,showButton:b,showTitle:D,triggerId:r,dateChanged:s,dateValue:d,calendarFirstDayOfWeek:C,datetimeId:_,labelPosition:h}}}),wt={key:0,slot:"title"};function Mt(e,t,d,i,r,_){const a=l("ion-input"),s=l("ion-label"),p=l("ion-datetime-button"),h=l("ion-datetime"),b=l("ion-modal");return u(),F(V,null,[e.asButton?O("",!0):(u(),S(a,{key:0,id:e.triggerId,label:e.label||e.name,"label-placement":e.labelPosition,readonly:!0,value:e.dateValue},null,8,["id","label","label-placement","value"])),e.asButton?(u(),S(s,{key:1,position:e.labelPosition},{default:n(()=>[I(g(e.label||e.name),1)]),_:1},8,["position"])):O("",!0),e.asButton?(u(),S(p,{key:2,datetime:e.datetimeId},{default:n(()=>[I(' " " ')]),_:1},8,["datetime"])):O("",!0),o(b,{class:"ion-datetime-button-overlay",trigger:e.triggerId,"keep-contents-mounted":!0,onWillPresent:t[0]||(t[0]=()=>e.datetimeFocus(!0)),onDidDismiss:t[1]||(t[1]=()=>e.datetimeFocus(!1))},{default:n(()=>[o(h,Z({id:e.datetimeId,"show-default-buttons":e.showButton,"show-default-title":e.showTitle,"first-day-of-week":e.calendarFirstDayOfWeek,value:e.modelValue},e.attrs,{onIonChange:e.dateChanged}),{default:n(()=>[e.showTitle?(u(),F("span",wt,"Select "+g(e.label||e.name),1)):O("",!0)]),_:1},16,["id","show-default-buttons","show-default-title","first-day-of-week","value","onIonChange"])]),_:1},8,["trigger"])],64)}const $e=N(kt,[["render",Mt],["__scopeId","data-v-ced8c79c"]]),Pt=B({components:{PageHeader:he,IonButton:z,IonIcon:J,IonLabel:H,IonGrid:Oe,IonRow:Te,IonCol:Fe,CustomSelect:It,CustomDate:$e,IonBackButton:Ve,IonButtons:ue,IonToolbar:ce,IonHeader:me,IonContent:x,IonProgressBar:Ee},emits:["save","cancel"],props:{formData:{type:Object,required:!0},schema:{type:Object,required:!0},isModal:{type:Boolean,required:!1,default(){return!1}},confirmCancel:Boolean,editMode:Boolean},setup(e,t){const d=j(),i=pe({...e.formData}),r={...e.schema},_=y(()=>r.fields.map(c=>({name:c.name,field:c}))),a=y(()=>e.editMode&&r.editTitle||r.title),{closeModal:s}=ge(),{rules:p}=gt(r,i),h=De(p,i,{$autoDirty:!1,$lazy:!0,$rewardEarly:!1}),b=async()=>{const c=await h.value.$validate(),m={...i};c&&(t.emit("save",m),e.isModal&&s(U.OK,m))},D=()=>{t.emit("cancel"),e.isModal&&s(U.Cancel)};return{icons:{closeOutline:fe},title:a,confirmAndProcessCancel:async()=>{if(e.confirmCancel){const c=await Be.create({htmlAttributes:{"aria-label":"alert dialog"},cssClass:"cancel-confirm-alert",header:"Cancel?",message:"Are you sure, you want to cancel?",buttons:[{text:"No",role:"cancel",cssClass:"alert-button-cancel"},{text:"Yes",role:"confirm",cssClass:"alert-button-confirm"}]});await c.present();const{role:m}=await c.onDidDismiss();m=="confirm"&&D()}else D()},processFormSubmit:b,formSchema:r,formFields:_,formState:i,store:d,v$:h}}}),At={class:"error-message"},Ot={key:0},Tt={class:"actions"};function Ft(e,t,d,i,r,_){const a=l("ion-icon"),s=l("ion-button"),p=l("PageHeader"),h=l("ion-col"),b=l("ion-row"),D=l("ion-grid"),C=l("ion-buttons"),c=l("ion-content");return u(),F(V,null,[o(p,{backButton:!e.isModal,title:e.title,progress:e.store.progress,waiting:e.store.progress,waitMessage:e.store.progressMessage},{buttons:n(()=>[e.isModal?O("",!0):(u(),S(s,{key:0,onClick:e.confirmAndProcessCancel},{default:n(()=>[o(a,{slot:"icon-only",icon:e.icons.closeOutline},null,8,["icon"])]),_:1},8,["onClick"]))]),_:1},8,["backButton","title","progress","waiting","waitMessage"]),o(c,null,{default:n(()=>[$("form",{novalidate:"",autocomplete:"off",onSubmit:t[0]||(t[0]=ve((...m)=>e.processFormSubmit&&e.processFormSubmit(...m),["stop","prevent"]))},[o(D,{fixed:!0,class:oe(e.formSchema.cssClass)},{default:n(()=>[(u(!0),F(V,null,q(e.formFields,({name:m,field:f})=>(u(),S(b,{key:f.name},{default:n(()=>{var w;return[o(h,{class:oe({errors:(w=e.v$[f.name])==null?void 0:w.$error})},{default:n(()=>{var v,k,T;return[(u(),S(Ne(f.component.fieldType),Z({name:f.name,label:f.component.label,type:f.component.type},f.attrs,{options:f.component.options,modelValue:e.v$[m].$model,"onUpdate:modelValue":E=>e.v$[m].$model=E,onIonBlur:E=>e.v$[m].$touch()}),null,16,["name","label","type","options","modelValue","onUpdate:modelValue","onIonBlur"])),$("div",At,[(v=e.v$[f.name])!=null&&v.$error||(k=e.v$[f.name])!=null&&k.$dirty?(u(),F("span",Ot,g((((T=e.v$[f.name])==null?void 0:T.$errors[0])||{}).$message),1)):O("",!0)])]}),_:2},1032,["class"])]}),_:2},1024))),128))]),_:1},8,["class"]),$("div",Tt,[o(C,null,{default:n(()=>[o(s,{id:"cancel",fill:"clear",class:"cancel",onClick:e.confirmAndProcessCancel},{default:n(()=>[I(g(e.formSchema.actions.cancel),1)]),_:1},8,["onClick"]),o(s,{class:"save",id:"save",fill:"solid",color:"primary",onClick:e.processFormSubmit},{default:n(()=>[I(g(e.formSchema.actions.submit),1)]),_:1},8,["onClick"])]),_:1})])],32)]),_:1})],64)}const Vt=N(Pt,[["render",Ft]]),Et={name:"patientForm",title:"Add new patient",editTitle:"Edit patient",cssClass:"form",actions:{cancel:"Cancel",submit:"Save",reset:"Reset"},fields:[{name:"name",component:{fieldType:"input",type:"text",label:"Name"},attrs:L.input,validations:{required:{},personName:{},minLength:{value:[5]}}},{name:"gender",component:{fieldType:"select",label:"Gender",options:[{text:"Male",value:"Male"},{text:"Female",value:"Female"}]},attrs:L.select,validations:{required:{}}},{name:"dob",component:{fieldType:"date",label:"Date of birth"},attrs:L.date,validations:{requiredUnless:{value:["age"],dependentProps:["age"],message:"Date of birth or Age is required."}}},{name:"age",component:{fieldType:"input",type:"number",label:"Age (in years)"},attrs:{...L.input,inputmode:"numeric"},validations:{requiredUnless:{value:["dob"],dependentProps:["dob"],message:"Date of birth or Age is required."},minValue:{value:[1]},maxValue:{value:[100]}}},{name:"phone",component:{fieldType:"input",type:"tel",label:"Phone number"},attrs:L.input,validations:{required:{},phone:{}}},{name:"address",component:{fieldType:"textarea",label:"Address"},attrs:L.textarea,validations:{required:{},minLength:{value:[5]}}}]},Bt=B({name:"PatientForm",components:{FormComponent:Vt},props:{isModal:Boolean,patient:Object},setup(e,t){const d=e.patient||Le(),i=Et,r=y(()=>e.patient!=null&&e.patient!=null),{closeModal:_}=ge(),a=j(),s=(b,D)=>{e.isModal&&_(b,D)};return{patientData:d,formSchema:i,processSave:async b=>{await a.savePatient(b),s(U.OK,b)},processCancel:()=>{s(U.Cancel)},editMode:r}}});function Nt(e,t,d,i,r,_){const a=l("FormComponent");return u(),S(a,{confirmCancel:!0,formData:e.patientData,schema:e.formSchema,isModal:!e.isModal,editMode:e.editMode,onSave:e.processSave,onCancel:e.processCancel},null,8,["formData","schema","isModal","editMode","onSave","onCancel"])}const Lt=N(Bt,[["render",Nt]]),Q=7,Se=14;function Rt(e,t){return isNaN(t)||e.length==0?!1:e.findIndex(d=>d.days.includes(t)&&d.start>0&&d.end>0)>-1}function qt(){const e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+Se-1)}function Ce(e){return W(e,Y.US_DATE)}function Ut(e,t,d){const i=[];return e.length==0||(pt(t,d).forEach(_=>{const a=new Date(_),s=Rt(e,a.getDay()),p=W(a,Y.ddd_DD_MMM);i.push({key:_,value:Ce(a),text:p,disabled:!s})}),console.log("ScheduleDateOptions",i)),i}function Ht(e,t){const d=Date.parse(e);if(isNaN(d)||t.length==0)return[];const i=new Date;let r=0;e==W(i,Y.US_DATE)&&(r=i.getHours());const _=new Date(d).getDay();return t.filter(a=>a.days.includes(_)&&a.start>0&&a.end>0&&(r==0||r<a.end)).map(a=>({value:a.timeSlotId,text:a.title,disabled:!1}))}function zt(e,t){const d=P(new Date().getTime()),i=P(new Date().getTime()),r=y(()=>Ut(G(e),le(d.value),Se));function _(m){const f=new Date(m),w=W(f,Y.US_DATE),v=r.value.find(k=>k.value.toString()==w);return v&&v.disabled==!1}const a=y(()=>r.value.length),s=y(()=>a.value>0?r.value[0].value:void 0),p=y(()=>a.value>0?r.value[a.value-1].value:void 0),h=y(()=>{const m=Ce(le(i.value)),f=r.value.findIndex(w=>w.value==m);return r.value.slice(f,f+Q)}),b=y(()=>Ht(G(t),G(e))),D=y(()=>i.value-new Date().getTime()>0),C=y(()=>{const m=new Date(h.value[h.value.length-1].value);return qt().getTime()-m.getTime()>0});return{fullScheduleOptions:r,scheduleDateOptions:h,isDateEnabled:_,minDate:s,maxDate:p,shiftTimeOptions:b,nextPrevSchedule:m=>{const f=m?Q:-1*Q;i.value=ft(i.value,f)},showSchedulePrev:D,showScheduleNext:C}}const ie="update:scheduleDate",re="update:scheduleTime",Wt=B({name:"ScheduleComponent",components:{IonLabel:H,IonIcon:J,IonSegment:Re,IonSegmentButton:qe,IonButton:z,IonList:ee,IonListHeader:Ue,IonItem:te,CustomDate:$e,IonItemGroup:He,IonItemDivider:ze},props:{scheduleDate:String,scheduleTime:String,doctorSchedules:Array,dateLabel:String,timeLabel:String,name:{type:String,required:!0},calenderView:Boolean,labelPosition:String},emits:[ie,re],setup(e,t){const d=P(e.scheduleDate),i=P(e.scheduleTime),r=y(()=>d.value?vt(d.value):"");K(()=>{i.value="",t.emit(ie,d.value)}),K(()=>{t.emit(re,i.value)});const _=P(t.attrs);X(()=>{_.value=t.attrs});const{fullScheduleOptions:a,scheduleDateOptions:s,shiftTimeOptions:p,isDateEnabled:h,nextPrevSchedule:b,showScheduleNext:D,showSchedulePrev:C,minDate:c,maxDate:m}=zt(e.doctorSchedules,d),f=a.value.filter(v=>v.disabled==!1).map(v=>({date:v.value,textColor:"#000000",backgroundColor:"#d8fce7"})),w=y(()=>({presentation:"date",min:c,max:m,showTitle:!1,isDateEnabled:h,locale:_t.EN_IN,showButtons:!0,highlightedDates:f}));return{icons:{chevronBackOutline:We,chevronForwardOutline:Ye},attrs:_,scheduleDateOptions:s,shiftTimeOptions:p,nextPrevSchedule:b,showScheduleNext:D,showSchedulePrev:C,dateRef:d,timeRef:i,calenderAttrs:w,selectedDateText:r}}}),Yt={key:1,class:"schedule-date"},jt={class:"schedule-date-header"},Gt={class:"schedule-date-next-prev"},Qt={class:"schedule-time"},Kt={class:"schedule-time-header"};function Xt(e,t,d,i,r,_){const a=l("ion-label"),s=l("ion-item-divider"),p=l("CustomDate"),h=l("ion-icon"),b=l("ion-button"),D=l("ion-buttons"),C=l("ion-segment-button"),c=l("ion-segment"),m=l("ion-item"),f=l("ion-note"),w=l("ion-item-group");return u(),S(w,null,{default:n(()=>[e.$slots.title?(u(),S(s,{key:0},{default:n(()=>[o(a,null,{default:n(()=>[R(e.$slots,"title",{},void 0,!0)]),_:3})]),_:3})):O("",!0),o(m,null,{default:n(()=>[e.calenderView?(u(),S(p,Z({key:0,name:"sch-date",asButton:!0,label:e.dateLabel,presentation:"date"},e.calenderAttrs,{modelValue:e.dateRef,"onUpdate:modelValue":t[0]||(t[0]=v=>e.dateRef=v)}),null,16,["label","modelValue"])):(u(),F("div",Yt,[$("div",jt,[o(a,{position:e.labelPosition},{default:n(()=>[I(g(e.dateLabel||"Date"),1)]),_:1},8,["position"]),$("div",Gt,[o(D,null,{default:n(()=>[o(b,{class:"prev-next-button",size:"small",fill:"clear",shape:"round",disabled:!e.showSchedulePrev,onClick:t[1]||(t[1]=v=>e.nextPrevSchedule(!1))},{default:n(()=>[o(h,{slot:"icon-only",icon:e.icons.chevronBackOutline},null,8,["icon"])]),_:1},8,["disabled"]),o(b,{class:"prev-next-button",size:"small",fill:"clear",shape:"round",disabled:!e.showScheduleNext,onClick:t[2]||(t[2]=v=>e.nextPrevSchedule(!0))},{default:n(()=>[o(h,{slot:"icon-only",icon:e.icons.chevronForwardOutline},null,8,["icon"])]),_:1},8,["disabled"])]),_:1})])]),o(c,{class:"appointment",modelValue:e.dateRef,"onUpdate:modelValue":t[3]||(t[3]=v=>e.dateRef=v),scrollable:!0,translate:"no"},{default:n(()=>[(u(!0),F(V,null,q(e.scheduleDateOptions,v=>(u(),S(C,{key:v.value,value:v.value,disabled:v.disabled},{default:n(()=>[o(a,null,{default:n(()=>[I(g(v.text),1)]),_:2},1024)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])])),R(e.$slots,"date-error",{},void 0,!0)]),_:3}),o(m,null,{default:n(()=>[$("div",Qt,[$("div",Kt,[o(a,{position:e.labelPosition},{default:n(()=>[I(g(e.timeLabel||"Time"),1)]),_:1},8,["position"])]),o(c,{class:"appointment",modelValue:e.timeRef,"onUpdate:modelValue":t[4]||(t[4]=v=>e.timeRef=v),scrollable:!0,translate:"no"},{default:n(()=>[(u(!0),F(V,null,q(e.shiftTimeOptions,v=>(u(),S(C,{key:v.value,value:v.value,disabled:v.disabled},{default:n(()=>[o(a,null,{default:n(()=>[I(g(v.text),1)]),_:2},1024)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"]),e.shiftTimeOptions.length==0?(u(),S(f,{key:0},{default:n(()=>[I(" No time slot avavilable on "+g(e.selectedDateText),1)]),_:1})):O("",!0)]),R(e.$slots,"time-error",{},void 0,!0)]),_:3})]),_:3})}const Zt=N(Wt,[["render",Xt],["__scopeId","data-v-d0bcfd11"]]),Jt=B({props:{selectedItem:Object,title:{type:String,default:"Select Patient"},itemName:String},emits:["selection-cancel","selection-change","add-edit-item"],components:{IonButton:z,IonButtons:ue,IonCheckbox:je,IonContent:x,IonHeader:me,IonItem:te,IonList:ee,IonTitle:Ge,IonSearchbar:Qe,IonToolbar:ce,IonRadioGroup:Ke,IonRadio:Xe,IonFab:Ze,IonFabButton:Je},setup(e,{emit:t}){const d=P(!1),i=P(null),r=P(e.selectedItem?[e.selectedItem]:[]),_=P(""),a=j();xe(()=>{console.log("onMounted:patient selector"),a.fetchPatients()});const{filteredItems:s}=$t(a.patients,["name","phone"],_,ae);return{icons:{addOutline:_e,closeOutline:fe,checkmarkOutline:et,createOutline:be,searchOutline:tt},filteredItems:s,workingSelectedValues:r,cancelChanges:()=>{t("selection-cancel")},confirmChanges:()=>{r.value.length>0&&t("selection-change",r.value)},searchbarInput:c=>{_.value=c.target.value},radioChange:c=>{const{value:m}=c.detail;r.value=[m]},comparePatient:ae,searchbarRef:i,addEditItem:c=>{t("add-edit-item",c)},showSearch:d}}}),xt={key:1,class:"no-item"};function en(e,t,d,i,r,_){const a=l("ion-icon"),s=l("ion-button"),p=l("ion-buttons"),h=l("ion-title"),b=l("ion-toolbar"),D=l("ion-searchbar"),C=l("ion-header"),c=l("ion-fab-button"),m=l("ion-fab"),f=l("ion-note"),w=l("ion-radio"),v=l("ion-item"),k=l("ion-radio-group"),T=l("ion-list"),E=l("ion-content");return u(),F(V,null,[o(C,null,{default:n(()=>[o(b,null,{default:n(()=>[o(p,{slot:"start"},{default:n(()=>[o(s,{onClick:t[0]||(t[0]=A=>e.cancelChanges())},{default:n(()=>[o(a,{slot:"icon-only",icon:e.icons.closeOutline},null,8,["icon"])]),_:1})]),_:1}),o(h,null,{default:n(()=>[I(g(e.title),1)]),_:1}),o(p,{slot:"end"},{default:n(()=>[R(e.$slots,"actions"),o(s,{size:"small",onClick:t[1]||(t[1]=()=>e.showSearch=!e.showSearch)},{default:n(()=>[o(a,{slot:"icon-only",icon:e.icons.searchOutline},null,8,["icon"])]),_:1}),o(s,{onClick:t[2]||(t[2]=A=>e.confirmChanges())},{default:n(()=>[o(a,{slot:"icon-only",icon:e.icons.checkmarkOutline},null,8,["icon"])]),_:1})]),_:3})]),_:3}),e.showSearch?(u(),S(b,{key:0},{default:n(()=>[o(D,{class:"searchbar",ref:"searchbarRef",placeholder:"Filter patients",onIonInput:t[3]||(t[3]=A=>e.searchbarInput(A))},null,512)]),_:1})):O("",!0)]),_:3}),o(E,{class:"ion-padding",fullscreen:!0},{default:n(()=>[o(m,{slot:"fixed",vertical:"bottom",horizontal:"end"},{default:n(()=>[o(c,{size:"small",onClick:t[4]||(t[4]=A=>e.addEditItem(null))},{default:n(()=>[o(a,{icon:e.icons.addOutline},null,8,["icon"])]),_:1})]),_:1}),e.workingSelectedValues.length==0?(u(),S(f,{key:0,class:"error-message"},{default:n(()=>[I(" Please select patient ")]),_:1})):O("",!0),e.filteredItems.length==0?(u(),F("div",xt,[o(f,null,{default:n(()=>[I("No patients found, add new patient.")]),_:1}),o(s,{size:"small",shape:"round",fill:"clear",onClick:t[5]||(t[5]=A=>e.addEditItem(null))},{default:n(()=>[o(a,{slot:"icon-only",icon:e.icons.addOutline},null,8,["icon"])]),_:1})])):O("",!0),e.filteredItems.length>0?(u(),S(T,{key:2,id:"modal-list",lines:"full"},{default:n(()=>[o(k,{value:e.selectedItem,compareWith:e.comparePatient,onIonChange:t[6]||(t[6]=A=>e.radioChange(A))},{default:n(()=>[(u(!0),F(V,null,q(e.filteredItems,A=>(u(),S(v,{key:A.id||A.name},{default:n(()=>[o(w,{value:A,"aria-label":A.name,"label-placement":"end",justify:"start"},{default:n(()=>[R(e.$slots,"itemView",{itemData:A})]),_:2},1032,["value","aria-label"]),o(a,{slot:"end",icon:e.icons.createOutline,onClick:M=>e.addEditItem(A)},null,8,["icon","onClick"])]),_:2},1024))),128))]),_:3},8,["value","compareWith"])]),_:3})):O("",!0)]),_:3})],64)}const tn=N(Jt,[["render",en]]),nn=B({name:"AppointmentForm",components:{PatientSelector:tn,ScheduleComponent:Zt,PatientForm:Lt,DoctorCard:ht,IonButton:z,IonItem:te,IonIcon:J,IonLabel:H,IonList:ee,IonModal:de,IonContent:x,PageHeader:he},props:{doctorId:{type:String,required:!0}},setup(e,t){const d=P(),i=P(!1),r=nt(),_=j();_.selectDoctor(e.doctorId);const a=y(()=>_.selectedDoctor),s=P(new ot({doctor:a.value,date:bt(),time:""}));K(()=>{a.value&&(s.value.doctor=a.value)});const p=pe(s),h={formName:"appointment",fieldValidations:{doctorId:{label:"Doctor",validations:{required:{}}},patient:{label:"Patient",validations:{notNull:{}}},date:{label:"Schedule Date",validations:{required:{}}},time:{label:"Schedule Time",validations:{required:{}}}}},{rules:b}=Dt(h,p),D=De(b,p,{$autoDirty:!1,$lazy:!0,$rewardEarly:!1}),C=()=>r.back(),c=async function(){var E;const k=await D.value.$validate(),T={...p};console.log("bookAppointment form submit",{appointmentModel:s.value,data:T,errors:(E=D.value)==null?void 0:E.$errors}),k?(console.log("booking appointment"),_.saveAppointment(s.value)):console.log("form is not valid")};function m(k){let T;k&&Array.isArray(k)&&k.length>0?T=k[0]:T=k,console.log("new person",T),T&&(s.value.patient=T,d.value.$el.dismiss())}const f=P(null);async function w(k){console.log("addEditPatient",k),f.value=k,i.value=!0}async function v(){f.value=void 0,i.value=!1}return{v$:D,icons:{arrowBack:at,location:lt,personOutline:st,calendarOutline:it,chevronBack:rt,chevronForward:dt,addOutline:_e,createOutline:be},appointmentModel:s,appointeeDoctor:a,cancelHandler:C,bookAppointment:c,addEditPatient:w,editingPatient:f,patientFormClosed:v,showPatientForm:i,patientSelectorModal:d,patientSelectionChanged:m}}}),on={class:"error error-message"},an={class:"error error-message"},ln={class:"patient-select"},sn={key:0,class:"error error-message"},rn={class:"actions"};function dn(e,t,d,i,r,_){const a=l("PageHeader"),s=l("DoctorCard"),p=l("ion-label"),h=l("ScheduleComponent"),b=l("ion-item-divider"),D=l("ion-icon"),C=l("ion-button"),c=l("ion-item"),m=l("ion-note"),f=l("ion-item-group"),w=l("ion-list"),v=l("ion-buttons"),k=l("PatientForm"),T=l("ion-modal"),E=l("PatientSelector"),A=l("ion-content");return u(),F(V,null,[o(a,{backButton:!0,title:"Appointment"}),o(A,null,{default:n(()=>[o(s,{class:"ion-padding",actions:!1,detail:!1,doctor:e.appointeeDoctor,loading:e.appointeeDoctor?e.appointeeDoctor.loading:!0},null,8,["doctor","loading"]),$("form",{novalidate:"",autocomplete:"off",onSubmit:t[2]||(t[2]=ve((...M)=>e.bookAppointment&&e.bookAppointment(...M),["stop","prevent"]))},[o(w,{lines:"full",inset:!0,class:"form"},{default:n(()=>[e.appointeeDoctor?(u(),S(h,{key:0,name:"schedule",dateLabel:"Date",timeLabel:"Time",calenderView:!0,doctorSchedules:e.appointeeDoctor.schedules,scheduleDate:e.appointmentModel.date,"onUpdate:scheduleDate":t[0]||(t[0]=M=>e.appointmentModel.date=M),scheduleTime:e.appointmentModel.time,"onUpdate:scheduleTime":t[1]||(t[1]=M=>e.appointmentModel.time=M),inset:!1},{title:n(()=>[o(p,null,{default:n(()=>[I(" Schedule ")]),_:1})]),"date-error":n(()=>[$("div",on,[$("span",null,g((e.v$.date.$errors[0]||{}).$message)+"   ",1)])]),"time-error":n(()=>[$("div",an,[$("span",null,g((e.v$.time.$errors[0]||{}).$message)+"   ",1)])]),_:1},8,["doctorSchedules","scheduleDate","scheduleTime"])):O("",!0),o(f,null,{default:n(()=>[o(b,null,{default:n(()=>[o(p,null,{default:n(()=>[I(" Patient ")]),_:1})]),_:1}),e.appointmentModel.patient?(u(),S(c,{key:0,lines:"none"},{default:n(()=>[o(p,{class:"summary"},{default:n(()=>[$("strong",null,g(e.appointmentModel.patient.name),1),$("p",null,g(e.appointmentModel.patient.gender)+" | "+g(e.appointmentModel.patient.age),1),$("p",null,g(e.appointmentModel.patient.address),1),$("p",null,g(e.appointmentModel.patient.phone),1)]),_:1}),o(C,{class:"edit",slot:"end",id:"select-patient",fill:"clear",size:"small"},{default:n(()=>[o(D,{slot:"start",icon:e.icons.createOutline},null,8,["icon"]),I(" Change ")]),_:1})]),_:1})):O("",!0),e.appointmentModel.patient?O("",!0):(u(),S(c,{key:1,lines:"none",button:!1},{default:n(()=>{var M,ne;return[$("div",ln,[o(m,null,{default:n(()=>[I("Click below button to add patient ")]),_:1}),o(C,{id:"select-patient",fill:"clear",shape:"round",expand:"full"},{default:n(()=>[o(D,{slot:"start",icon:e.icons.addOutline},null,8,["icon"]),I(" Patient ")]),_:1})]),(M=e.v$.patient)!=null&&M.$error?(u(),F("div",sn,[$("span",null,g((((ne=e.v$.patient)==null?void 0:ne.$errors[0])||{}).$message),1)])):O("",!0)]}),_:1}))]),_:1})]),_:1}),$("div",rn,[o(v,null,{default:n(()=>[o(C,{fill:"clear",onClick:e.cancelHandler},{default:n(()=>[I(" Cancel ")]),_:1},8,["onClick"]),o(C,{fill:"solid",color:"primary",onClick:e.bookAppointment},{default:n(()=>[I(" Book ")]),_:1},8,["onClick"])]),_:1})])],32),o(T,{isOpen:e.showPatientForm,onDidDismiss:e.patientFormClosed},{default:n(()=>[o(k,{isModal:!0,patient:e.editingPatient},null,8,["patient"])]),_:1},8,["isOpen","onDidDismiss"]),o(T,{trigger:"select-patient",ref:"patientSelectorModal"},{default:n(()=>[o(E,{title:"Select patient",selectedItem:e.appointmentModel.patient,onSelectionChange:t[3]||(t[3]=M=>e.patientSelectionChanged(M)),onSelectionCancel:t[4]||(t[4]=M=>e.patientSelectorModal.$el.dismiss()),onAddEditItem:e.addEditPatient},{itemView:n(({itemData:M})=>[o(p,null,{default:n(()=>[$("strong",null,g(M.name),1),$("p",null,g(M.gender)+" | "+g(M.age),1),$("p",null,g(M.address),1),$("p",null,g(M.phoneNumber),1)]),_:2},1024)]),_:1},8,["selectedItem","onAddEditItem"])]),_:1},512)]),_:1})],64)}const un=N(nn,[["render",dn],["__scopeId","data-v-b86ffc01"]]),cn=B({components:{AppointmentForm:un,IonPage:ut},props:{doctorId:{type:String,required:!0}},setup(e,t){return{paramToString:ct}}});function mn(e,t,d,i,r,_){const a=l("AppointmentForm"),s=l("ion-page");return u(),S(s,null,{default:n(()=>[o(a,{doctorId:e.paramToString(e.$route.params.doctorId)},null,8,["doctorId"])]),_:1})}const $n=N(cn,[["render",mn]]);export{$n as default};
